<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>India Telecom Data</title>
        <script type="text/javascript" src="./d3.js"></script>
	<style type="text/css">
		    #map {   
				position: absolute;	
				border-radius: 25px; 
				padding: 10px;
				width:1000px;
				height:1000px; 
				border:1px solid black;
				font-family: "Arial", Arial, sans-serif
			}



			#data {    
				position: absolute;			
				text-align: center;			
				width: 300px;					
				height: 280px;					
				padding: 2px;				
				font: 12px sans-serif;		
				background: lightsteelblue;	
				border: 0px;		
				border-radius: 8px;			
				pointer-events: none;	
			}
			/* No style rules here yet */		
		</style>
	</head>
	<body>
		<div id="map"></div>
		<script type="text/javascript"> 
			var datadiv=d3.select("body")
						.append("div")
						.attr("id","data")
						.style("opacity",0)
						.style("display","none")
						.on("click",function(){console.log("CLicked DATADIV")
					});
			var w = 1000;
			var h = 1000;
			var svg = d3.select("#map")
				.append("svg")
				.attr("width", w)
				.attr("height", h)
			

			//Define default path generator
			var projection = d3.geo.mercator()
				.scale(8700)
				.translate([-1580,1050])
				.precision(.1);
		
			var path = d3.geo.path()
				.projection(projection);
		//Create SVG element
		
			
			//Load in GeoJSON data
			//Width and height
			
						
			
			function basemap(){
				
				 d3.json("./indiatelecomcirclebitswithcirclename.json", function(json) {
					//Bind data and create one path per GeoJSON feature
					svg.selectAll("path")
					   .data(json.features)
					   .enter()
					   .append("path")
					   .attr("d", path)
					   .attr("fill","#AAB050")
					   .on("click",function(d){
							datadiv.style("opacity",0)
							
							//d3.select("#data").remove()
							var thiscircle=d.properties['CIRCLE']
							var otherstates=svg.selectAll("path").filter(function(e){
								return e.properties['CIRCLE']==thiscircle;
							});
							otherstates.transition().duration(750).attr("fill","#CCCCCC")
							d3.select(this).transition().duration(750).attr("fill","#CCCCCC")
							var xPosition =  d3.event.pageX+100
							var yPosition =  d3.event.pageY+100
							console.log(xPosition+","+yPosition)
							datadiv.style("top",yPosition+"px").style("left",xPosition+"px").style("opacity",1).style("display","block")
							
						})
						
					   .on("mouseover", function(d) {
							var thiscircle=d.properties['CIRCLE']
							var otherstates=svg.selectAll("path").filter(function(e){
								return e.properties['CIRCLE']==thiscircle;
							});
							otherstates.transition().duration(750).attr("fill","#BBBBBB")
							d3.select(this).transition().duration(750).attr("fill","#BBBBBB")
							var xPosition =  d3.mouse(this)[0]+10;
							var yPosition =  d3.mouse(this)[1]+14;
							//Create the tooltip label
							svg.append("text")
								.attr("id", "tooltip")
								.attr("x", xPosition)
								.attr("y", yPosition)
								.attr("text-anchor", "middle")
								.attr("font-family", "sans-serif")
								.attr("font-size", "11px")
								.attr("font-weight", "bold")
								.attr("fill", "black")
								.text(d.properties['NAME_1']);
						})
					   .on("mouseout", function(d){
						   var thiscircle=d.properties['CIRCLE']
							var otherstates=svg.selectAll("path").filter(function(e){
								return e.properties['CIRCLE']==thiscircle;
							});
							otherstates.transition().duration(750).attr("fill","#AAB050")
							d3.select(this).transition().duration(750).attr("fill","#AAB050")
							d3.select("#tooltip").remove()
							
							
						});
				
					});
				//console.log(svg)
					
			}
			basemap();
			//console.log(svg)
			
		</script>
	</body>
</html>
